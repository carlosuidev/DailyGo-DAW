<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
</head>

<body>
    <nav class="navbar navbar-dark bg-dark fixed-top mb-5">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">DailyGo Doc</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas"
                data-bs-target="#offcanvasDarkNavbar" aria-controls="offcanvasDarkNavbar"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasDarkNavbar"
                aria-labelledby="offcanvasDarkNavbarLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasDarkNavbarLabel">Menú</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
                        aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                        <li class="nav-item">
                            <a class="nav-link" href="index.html">Global</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="usuarios.html">Usuarios</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="proveedores.html">Proveedores</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="riders.html">Riders</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="administrador.html">Administrador</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <div class="pt-5 pb-5">
    </div>

    <article class="container border rounded py-2 mb-3">
        <h4 class="bg-primary text-white rounded p-2 mb-4">actualizar_datos.js</h4>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">iniciarPerfil()</p>
                <small style="font-size: 0.8rem">Inicia los eventos para actualizar los datos del usuario</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function iniciarPerfil() {
                        mostrarDatos();
                        nombre.addEventListener("input", validarNombre);
                        apellidos.addEventListener("input", validarApellidos);
                        telefono.addEventListener("input", validarTelefono);
                        correo.addEventListener("input", validarCorreo);
                        contrasenaNueva.addEventListener("input", validarContrasena);
                    
                        btnNombre.addEventListener("click", cambiarNombre);
                        btnApellidos.addEventListener("click", cambiarApellidos);
                        btnTelefono.addEventListener("click", cambiarTelefono);
                        btnCorreo.addEventListener("click", cambiarCorreo);
                        btnContrasena.addEventListener("click", cambiarContrasena);
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">mostrarDatos()</p>
                <small style="font-size: 0.8rem">Muestra los datos actuales del usuario en los inputs</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function mostrarDatos() {
                        nombre.value = localStorage.getItem("nombre");
                        apellidos.value = localStorage.getItem("apellidos");
                        telefono.value = localStorage.getItem("telefono");
                        correo.value = localStorage.getItem("correo");
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarNombre()</p>
                <small style="font-size: 0.8rem">Valida que el nombre nuevo cumple con los requisitos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarNombre() {
                        const expNombre = /^([a-zA-ZáéíóúÁÉÍÓÚñÑüÜñ]{2,20}\s?)+$/;
                        if (expNombre.test(nombre.value)) {
                            nombre.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            msgNombre.setAttribute("class", "hidden");
                            validacionNombre = true;
                        } else {
                            nombre.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            msgNombre.setAttribute("class", "flex");
                            validacionNombre = false;
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarApellidos()</p>
                <small style="font-size: 0.8rem">Valida que los apellidos nuevos cumplen con los requisitos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarApellidos() {
                        const expApellidos = /^([a-zA-ZáéíóúÁÉÍÓÚñÑüÜñ]{2,}\s?-?\s?){1,4}$/;
                        if (expApellidos.test(apellidos.value)) {
                            apellidos.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            msgApellidos.setAttribute("class", "hidden");
                            validacionApellidos = true;
                        } else {
                            nombrapellidos.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            msgApellidos.setAttribute("class", "flex");
                            validacionApellidos = false;
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarTelefono()</p>
                <small style="font-size: 0.8rem">Valida que el nombre nuevo cumple con los requisitos y no existe en la
                    BBDD</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarTelefono() {
                        const expTelefono = /^(6|7|8|9)\d{8}$/;
                        if (expTelefono.test(telefono.value)) {
                            telefono.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            msgTelefono.setAttribute("class", "hidden");
                            msgTelefonoExiste.setAttribute("class", "hidden");
                            validacionTelefono = true;
                        } else {
                            telefono.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            msgTelefono.setAttribute("class", "flex");
                            msgTelefonoExiste.setAttribute("class", "hidden");
                            validacionTelefono = false;
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarCorreo()</p>
                <small style="font-size: 0.8rem">Valida que el correo nuevo cumple con los requisitos y no existe en la
                    BBDD</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarCorreo() {
                        const expCorreo = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$/;
                        if (expCorreo.test(correo.value)) {
                            correo.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            msgCorreo.setAttribute("class", "hidden");
                            msgCorreoExiste.setAttribute("class", "hidden");
                            validacionCorreo = true;
                    
                        } else {
                            correo.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            msgCorreo.setAttribute("class", "flex");
                            msgCorreoExiste.setAttribute("class", "hidden");
                            validacionCorreo = false;
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarContrasena()</p>
                <small style="font-size: 0.8rem">Valida que la contraseña nueva cumple con los requisitos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarContrasena() {
                        const expContrasena =
                            /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)([A-Za-z\d$@$!%*?&]|[^ ]){8,16}$/;
                        if (expContrasena.test(contrasenaNueva.value)) {
                            contrasenaNueva.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            msgContrasenaNueva.setAttribute("class", "hidden");
                            validacionContrasenhaNueva = true;
                        } else {
                            contrasenaNueva.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            msgContrasenaNueva.setAttribute("class", "flex");
                            validacionContrasenhaNueva = false;
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">actualizarDatos()</p>
                <small style="font-size: 0.8rem">Petición ajax para actualizar el tipo de dato en la BBDD</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function actualizarDatos(ruta, datos) {
                        fetch(ruta, {
                            method: "POST",
                            body: JSON.stringify(datos),
                            headers: {
                                "Content-Type": "application/json"
                            }
                        })
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error('Error en la solicitud');
                                }
                                return response.text();
                            })
                            .then(data => {
                                console.log(data)
                                switch (data) {
                                    case "actualizadoNombre":
                                        correctoDatos.setAttribute("class", "flex");
                                        setTimeout(function () {
                                            correctoDatos.setAttribute("class", "hidden");
                                        }, 3000);
                                        localStorage.setItem("nombre", nombre.value);
                                        break;
                                    case "actualizadoApe":
                                        correctoDatos.setAttribute("class", "flex");
                                        setTimeout(function () {
                                            correctoDatos.setAttribute("class", "hidden");
                                        }, 3000);
                                        localStorage.setItem("apellidos", apellidos.value);
                                        break;
                                    case "actualizadoTel":
                                        correctoDatos.setAttribute("class", "flex");
                                        setTimeout(function () {
                                            correctoDatos.setAttribute("class", "hidden");
                                        }, 3000);
                                        localStorage.setItem("telefono", telefono.value);
                                        break;
                                    case "actualizadoMail":
                                        correctoDatos.setAttribute("class", "flex");
                                        setTimeout(function () {
                                            correctoDatos.setAttribute("class", "hidden");
                                        }, 3000);
                                        localStorage.setItem("correo", correo.value);
                                        break;
                                    case "actualizadoContra":
                                        correctoContrasena.setAttribute("class", "flex");
                                        setTimeout(function () {
                                            correctoContrasena.setAttribute("class", "hidden");
                                        }, 3000);
                                        localStorage.setItem("correo", correo.value);
                                        break;
                                    case "telExiste":
                                        telefono.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                                        msgTelefono.setAttribute("class", "hidden");
                                        msgTelefonoExiste.setAttribute("class", "flex");
                                        setTimeout(function () {
                                            correctoDatos.setAttribute("class", "hidden");
                                        }, 3000);
                                        break;
                                    case "mailExiste":
                                        correo.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                                        msgCorreo.setAttribute("class", "hidden");
                                        msgCorreoExiste.setAttribute("class", "flex");
                                        setTimeout(function () {
                                            correctoDatos.setAttribute("class", "hidden");
                                        }, 3000);
                                        break;
                                    case "contraExiste":
                                        incorrectoContrasena.setAttribute("class", "flex");
                                        setTimeout(function () {
                                            incorrectoContrasena.setAttribute("class", "hidden");
                                        }, 3000);
                                        break;
                                }
                    
                            })
                            .catch(error => {
                                console.error("Error: ", error);
                                return false;
                            });
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">cambiarNombre()</p>
                <small style="font-size: 0.8rem">Envío de datos a la petición para cambiar el nombre</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function cambiarNombre() {
                        if (validacionNombre) {
                            const datos = {
                                'nombre': nombre.value,
                                'id': localStorage.getItem("id")
                            }
                            actualizarDatos("../../php/usuarios/actualizar_datos_usuario.php", datos);
                    
                        }
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">cambiarApellidos()</p>
                <small style="font-size: 0.8rem">Envío de datos a la petición para cambiar los apellidos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function cambiarApellidos() {
                        if (validacionApellidos) {
                            const datos = {
                                'apellidos': apellidos.value,
                                'id': localStorage.getItem("id")
                            }
                            actualizarDatos("../../php/usuarios/actualizar_datos_usuario.php", datos);
                    
                        }
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">cambiarTelefono()</p>
                <small style="font-size: 0.8rem">Envío de datos a la petición para cambiar el teléfono</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function cambiarTelefono() {
                        if (validacionTelefono) {
                            const datos = {
                                'telefono': telefono.value,
                                'id': localStorage.getItem("id")
                            }
                            actualizarDatos("../../php/usuarios/actualizar_datos_usuario.php", datos);
                    
                        }
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">cambiarCorreo()</p>
                <small style="font-size: 0.8rem">Envío de datos a la petición para cambiar el mail</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function cambiarCorreo() {
                        if (validacionCorreo) {
                            const datos = {
                                'correo': correo.value,
                                'id': localStorage.getItem("id")
                            }
                            actualizarDatos("../../php/usuarios/actualizar_datos_usuario.php", datos);
                        }
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">cambiarContrasena()</p>
                <small style="font-size: 0.8rem">Envío de datos a la petición para cambiar la contraseña</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function cambiarContrasena() {
                        if (validacionContrasenhaNueva) {
                            const datos = {
                                'contrasenaActual': contrasenaActual.value,
                                'contrasenaNueva': contrasenaNueva.value,
                                'id': localStorage.getItem("id")
                            }
                            actualizarDatos("../../php/usuarios/actualizar_datos_usuario.php", datos);
                        }
                    }
                </code>
            </pre>
        </section>
    </article>

    <article class="container border rounded py-2 mb-3">
        <h4 class="bg-primary text-white rounded p-2 mb-4">carrito.js</h4>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">iniciarCarrito()</p>
                <small style="font-size: 0.8rem">Inicia los eventos para usar el carrito</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function iniciarCarrito() {
                        mostrarBarraProductos();
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">mostrarBarraProductos()</p>
                <small style="font-size: 0.8rem">Muestra la barra de productos con los elementos del carrito</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function mostrarBarraProductos() {
                        enlacePedido();
                        listCarrito.innerHTML = "";
                    
                        if (typeof localStorage !== "undefined" && localStorage.getItem("miCarrito") && JSON.parse(localStorage.getItem("miCarrito")).length >= 1) {
                            let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                            carrito.forEach(producto => {
                                listCarrito.appendChild(crearComponenteProductoCarrito(producto));
                            });
                            calcularImporte();
                        } else {
                            listCarrito.innerHTML = "No tienes ningún producto en tu carrito :(";
                            totalBar.innerHTML = "0.00€";
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">addProducto()</p>
                <small style="font-size: 0.8rem">Añade un producto en el carrito y comprueba si ya existe o si es de
                    otra tienda</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function addProducto(id, precio, nombre, tienda) {
                        if (typeof localStorage !== "undefined" && localStorage.getItem("miCarrito")) {
                            let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                    
                            // Si es un item de la misma tienda guardar sino eliminar todo y volver a añadir
                            if (!validarTienda(carrito, tienda)) {
                                const posicion = obtenerPosicionProducto(carrito, id);
                                if (posicion != -1) {
                                    if (carrito[posicion].cantidad != 99) {
                                        carrito[posicion].cantidad = carrito[posicion].cantidad + 1;
                                    } else {
                                        return true;
                                    }
                                } else {
                                    nuevoProducto = crearNuevoProducto(id, precio, nombre, tienda);
                                    carrito.push(nuevoProducto);
                                }
                            } else {
                                listCarrito.innerHTML = "";
                                listCarrito.innerHTML = `
                                div class="w-fit rounded-lg bg-blue-700 text-yellow-400 text-center p-3 h-full animate__animated animate__fadeIn">
                                    p class="text-sm">⚠️ Se han retirado los productos de otras tiendas/p>
                                /div>
                                `;
                                setTimeout(function () {
                                    addProducto(id, precio, nombre, tienda);
                                    mostrarBarraProductos();
                                }, 3500);
                                localStorage.removeItem("miCarrito");
                    
                                return true;
                            }
                    
                            localStorage.setItem("miCarrito", JSON.stringify(carrito));
                            mostrarBarraProductos();
                        } else {
                            let arrayObj = [];
                            nuevoProducto = crearNuevoProducto(id, precio, nombre, tienda);
                            arrayObj.push(nuevoProducto);
                            localStorage.setItem("miCarrito", JSON.stringify(arrayObj));
                        }
                    
                        mostrarBarraProductos();
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarTienda()</p>
                <small style="font-size: 0.8rem">Comprueba la tienda de los elementos del carrito para evitar diferentes
                    tiendas en el mismo pedido</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarTienda(carrito, tienda) {
                        const pos = carrito.findIndex(function (producto) {
                            return producto.tienda == tienda;
                        });
                    
                        if (pos == -1) {
                            return true;
                        } else {
                            return false;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">crearNuevoProducto()</p>
                <small style="font-size: 0.8rem">Crea un nuevo objeto con los datos del producto</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function crearNuevoProducto(id, precio, nombre, tienda) {
                        return { id: id, precio: precio, nombre: nombre, cantidad: 1, tienda: tienda };
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">obtenerPosicionProducto()</p>
                <small style="font-size: 0.8rem">Busca la posición del producto en el carrito</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function obtenerPosicionProducto(carrito, idProd) {
                        const pos = carrito.findIndex(function (producto) {
                            return producto.id == idProd;
                        });
                    
                        return pos;
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">aumentarCantidad()</p>
                <small style="font-size: 0.8rem">Aumenta la cantida de un producto en el carrito</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function aumentarCantidad(id) {
                        try {
                            let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                    
                            let posicion = obtenerPosicionProducto(carrito, id);
                    
                            if (carrito[posicion].cantidad != 99) {
                                carrito[posicion].cantidad = carrito[posicion].cantidad + 1;
                            }
                    
                            localStorage.setItem("miCarrito", JSON.stringify(carrito));
                    
                            mostrarBarraProductos();
                    
                            return true;
                        } catch (e) {
                            return false;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">reducirCantidad()</p>
                <small style="font-size: 0.8rem">Reduce la cantidad de un producto o lo elimina en caso de reducir de 1
                    a 0</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function reducirCantidad(id) {
                        try {
                            let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                    
                            let posicion = obtenerPosicionProducto(carrito, id);
                    
                            if (carrito[posicion].cantidad == 1) {
                                eliminarProducto(id);
                                return true;
                            } else {
                                carrito[posicion].cantidad = carrito[posicion].cantidad - 1;
                                localStorage.setItem("miCarrito", JSON.stringify(carrito));
                            }
                    
                            mostrarBarraProductos();
                    
                            return true;
                        } catch (e) {
                            return false;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">eliminarProducto()</p>
                <small style="font-size: 0.8rem">Elimina un producto del carrito</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function eliminarProducto(id) {
                        let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                        carrito.splice(obtenerPosicionProducto(carrito, id), 1);
                        localStorage.setItem("miCarrito", JSON.stringify(carrito));
                        mostrarBarraProductos();
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">crearComponenteProductoCarrito()</p>
                <small style="font-size: 0.8rem">Crea un componente del producto para visualizarlo en la barra</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function crearComponenteProductoCarrito(element) {
                        const componente = document.createElement("div");
                        componente.setAttribute("class", "bg-blue-700 px-3 py-2 rounded-lg w-fit");
                        const producto = document.createElement("p");
                        producto.textContent = element.nombre;
                        producto.setAttribute("class", "text-sm text-white font-semibold");
                        componente.appendChild(producto);
                    
                        const divUd = document.createElement("div");
                        divUd.setAttribute("class", "flex items-center h-fit mt-1 gap-1.5");
                        const ud = document.createElement("p");
                        ud.setAttribute("class", "text-xs text-white/60 mr-2");
                        ud.textContent = element.cantidad;
                        divUd.appendChild(ud);
                    
                        const btnMas = document.createElement("button");
                        btnMas.setAttribute("class", "mr-1 bg-indigo-700 hover:bg-indigo-800 duration-300 rounded-full h-5 w-5 flex items-center justify-center");
                        btnMas.setAttribute("onclick", `aumentarCantidad(${element.id})`);
                        btnMas.textContent = "+";
                        divUd.appendChild(btnMas);
                    
                        const btnMenos = document.createElement("button");
                        btnMenos.setAttribute("class", "mr-1 bg-indigo-700 hover:bg-indigo-800 duration-300 rounded-full h-5 w-5 flex items-center justify-center");
                        btnMenos.setAttribute("onclick", `reducirCantidad(${element.id})`);
                        btnMenos.textContent = "-";
                        divUd.appendChild(btnMenos);
                        componente.appendChild(divUd);
                    
                        return componente;
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">enlacePedido()</p>
                <small style="font-size: 0.8rem">Modifica el botón de la barra para redirigir a un sitio dependiendo si
                    hay productos o no</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function enlacePedido() {
                        const enlace = document.getElementById("enlacePedido");
                        if (typeof localStorage !== "undefined" && localStorage.getItem("miCarrito")) {
                            if (JSON.parse(localStorage.getItem("miCarrito")).length) {
                                enlace.setAttribute("href", "carrito.html");
                                enlace.textContent = "Pedir ahora";
                            } else {
                                enlace.setAttribute("href", "busqueda_tiendas.php");
                                enlace.textContent = "Buscar tiendas";
                            }
                    
                        } else {
                            enlace.setAttribute("href", "busqueda_tiendas.php");
                            enlace.textContent = "Buscar tiendas";
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">calcularImporte()</p>
                <small style="font-size: 0.8rem">Calcula el importe del pedido incluyendo el envío</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function calcularImporte() {
                        if (typeof localStorage !== "undefined" && localStorage.getItem("miCarrito") && JSON.parse(localStorage.getItem("miCarrito")).length >= 1) {
                            let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                            let total = 0.00;
                            let cantidad = 0;
                            carrito.forEach(producto => {
                                if (producto.cantidad == 1) {
                                    total += producto.precio;
                                } else {
                                    total += (producto.precio * producto.cantidad);
                                }
                                cantidad += producto.cantidad;
                            });
                            contadorPedidos.innerHTML = cantidad;
                            // Suma gastos de envío (1.90 + 0.12 cent por cada unidad)
                            total = total + 1.90 + (0.12 * cantidad);
                            totalBar.textContent = `${total.toFixed(2)}€`;
                        } else {
                            contadorPedidos.innerHTML = 0;
                            totalBar.textContent = "0.00€";
                        }
                    }
                </code>
            </pre>
        </section>
    </article>

    <article class="container border rounded py-2 mb-3">
        <h4 class="bg-primary text-white rounded p-2 mb-4">crear_pedido.js</h4>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">iniciarResumenCompra()</p>
                <small style="font-size: 0.8rem">Inicia los eventos para crear un pedido</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function iniciarResumenCompra() {
                        mostrarProductos();
                        calcularCostes();
                    
                        aplicarCupon.addEventListener("click", aplicarDescuento);
                        realizarPago.addEventListener("click", procesarPedido);
                    
                        // VALIDAR
                        direccion.addEventListener("input", validarDireccion);
                        piso.addEventListener("input", validarPiso);
                        puerta.addEventListener("input", validarPuerta);
                    
                        tarjeta.addEventListener("input", validarTarjeta);
                        cvv.addEventListener("input", validarCVV);
                        caducidad.addEventListener("input", validarCaducidad);
                        titular.addEventListener("input", validarTitular);
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">procesarPedido()</p>
                <small style="font-size: 0.8rem">Envío de petición para crear el pedido y guardarlo en la BBDD</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function procesarPedido() {
                        validarDireccion();
                        validarPiso();
                        validarPuerta();
                        validarTarjeta();
                        validarCVV();
                        validarCaducidad();
                        validarTitular();
                    
                        if (validarDireccion() &&
                            validarPiso() &&
                            validarPuerta() &&
                            validarTarjeta() &&
                            validarCVV() &&
                            validarCaducidad() &&
                            validarTitular()
                        ) {
                            const idUsu = localStorage.getItem("id");
                    
                            const datos = {
                                id: idUsu,
                                carrito: localStorage.getItem("miCarrito"),
                                direccion: direccion.value,
                                piso: piso.value,
                                puerta: puerta.value,
                                mensaje: mensaje.value
                            }
                    
                            fetch("../../php/usuarios/crear_pedido.php", {
                                method: "POST",
                                body: JSON.stringify(datos),
                                headers: {
                                    "Content-Type": "application/json"
                                }
                            })
                                .then(response => response.text())
                                .then(data => {
                                    if (data == "Creado") {
                                        localStorage.removeItem("miCarrito");
                                        window.location.href = "pedidos.html"
                                    }
                                })
                                .catch(error => {
                                    console.error(error);
                                });
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">aplicarDescuento()</p>
                <small style="font-size: 0.8rem">Aplica un descuento según el código usado</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function aplicarDescuento() {
                        calcularCostes();
                        switch (codigo.value) {
                            case "DAILY10":
                                calcularCostesDescuento(0.10);
                                break;
                            case "DAILY20":
                                calcularCostesDescuento(0.20);
                                break;
                            case "ENVIO23":
                                calcularCostesSinEnvio()
                                break;
                            default:
                                calcularCostes();
                                break;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">calcularCostesDescuento()</p>
                <small style="font-size: 0.8rem">Calcula los descuentos para aplicar el nuevo precio</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function calcularCostesDescuento(reduccion) {
                        if (typeof localStorage !== "undefined" && localStorage.getItem("miCarrito") && JSON.parse(localStorage.getItem("miCarrito")).length >= 1) {
                            let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                            let totalValor = 0.00;
                            let cantidad = 0;
                            carrito.forEach(producto => {
                                if (producto.cantidad == 1) {
                                    totalValor += producto.precio;
                                } else {
                                    totalValor += (producto.precio * producto.cantidad);
                                }
                                cantidad += producto.cantidad;
                            });
                            subtotal.textContent = totalValor.toFixed(2);
                            // Suma gastos de envío (1.90 + 0.12 cent por cada unidad);
                            envio.textContent = (1.90 + (0.12 * cantidad)).toFixed(2);
                            totalValor = totalValor + 1.90 + (0.12 * cantidad) - (totalValor*reduccion);
                            descuento.textContent = (totalValor*reduccion).toFixed(2);
                            total.textContent = totalValor.toFixed(2);
                        } else {
                            descuento.textContent = 0.00;
                            subtotal.textContent = 0.00;
                            total.textContent = 0.00;
                            envio.textContent = 0.00;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">calcularCostesSinEnvio()</p>
                <small style="font-size: 0.8rem">Calcula los costes por defecto (sin envío)</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function calcularCostesSinEnvio() {
                        if (typeof localStorage !== "undefined" && localStorage.getItem("miCarrito") && JSON.parse(localStorage.getItem("miCarrito")).length >= 1) {
                            let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                            let totalValor = 0.00;
                            let cantidad = 0;
                            carrito.forEach(producto => {
                                if (producto.cantidad == 1) {
                                    totalValor += producto.precio;
                                } else {
                                    totalValor += (producto.precio * producto.cantidad);
                                }
                                cantidad += producto.cantidad;
                            });
                            subtotal.textContent = totalValor.toFixed(2);
                            // Suma gastos de envío (1.90 + 0.12 cent por cada unidad);
                            envio.textContent = 0.00;
                            descuento.textContent = 0.00;
                            total.textContent = totalValor.toFixed(2);
                        } else {
                            descuento.textContent = 0.00;
                            subtotal.textContent = 0.00;
                            total.textContent = 0.00;
                            envio.textContent = 0.00;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarDireccion()</p>
                <small style="font-size: 0.8rem">Valida la dirección del envío</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarDireccion() {
                        const expDireccion = /^[a-zA-ZáéíóúÁÉÍÓÚñÑüÜ\s\d.',-]+$/u;
                        if (expDireccion.test(direccion.value)) {
                            direccion.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return true;
                        } else {
                            direccion.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return false;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarPiso()</p>
                <small style="font-size: 0.8rem">Valida el piso</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarPiso() {
                        const expPiso = /^(?:1\d{2}|200|[1-9]\d?)$/;
                        if (expPiso.test(piso.value)) {
                            piso.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return true;
                        } else {
                            piso.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return false;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarPuerta()</p>
                <small style="font-size: 0.8rem">Valida la puerta</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarPuerta() {
                        const expPuerta = /^[a-zA-Z]$/;;
                        if (expPuerta.test(puerta.value)) {
                            puerta.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return true;
                        } else {
                            puerta.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return false;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarTarjeta()</p>
                <small style="font-size: 0.8rem">Valida la tarjeta VISA o MasterCard</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarTarjeta() {
                        const expTarjeta = /^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14})$/;
                        if (expTarjeta.test(tarjeta.value)) {
                            tarjeta.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return true;
                        } else {
                            tarjeta.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return false;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarCVV()</p>
                <small style="font-size: 0.8rem">Valida el CVV de la tarjeta</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarCVV() {
                        const expCaducidad = /^\d{3}$/;
                        if (expCaducidad.test(cvv.value)) {
                            cvv.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return true;
                        } else {
                            cvv.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return false;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarCaducidad()</p>
                <small style="font-size: 0.8rem">Valida la caducidad de la tarjeta</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarCaducidad() {
                        const fechaActual = new Date();
                        const fechaAyer = new Date(fechaActual);
                        fechaAyer.setDate(fechaAyer.getDate() - 1);
                        const fechaFormulario = new Date(caducidad.value);
                        if (fechaFormulario > fechaAyer) {
                            caducidad.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return true;
                        } else {
                            caducidad.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return false;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarTitular()</p>
                <small style="font-size: 0.8rem">Valida el titular de la tarjeta</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarTitular() {
                        const expTitular = /^([a-zA-ZáéíóúÁÉÍÓÚñÑüÜñ]{2,}\s?-?\s?){1,4}$/;
                        if (expTitular.test(titular.value)) {
                            titular.setAttribute("class", "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return true;
                        } else {
                            titular.setAttribute("class", "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300");
                            return false;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">mostrarProductos()</p>
                <small style="font-size: 0.8rem">Muestra todos los productos del carrito en una tabla</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function mostrarProductos() {
                        const listaProductosTabla = document.getElementById("listaProductosTabla");
                        listaProductosTabla.innerHTML = "";
                        if (typeof localStorage !== "undefined" && localStorage.getItem("miCarrito") && JSON.parse(localStorage.getItem("miCarrito")).length >= 1) {
                            let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                    
                            carrito.forEach(producto => {
                                listaProductosTabla.appendChild(crearFila(producto));
                            });
                        } else {
                            listaProductosTabla.innerHTML = "tr>td class='p-4 text-sm'>(Sin productos)/td>/tr>";
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">calcularCostes()</p>
                <small style="font-size: 0.8rem">Calcula los costes totales</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function calcularCostes() {
                        if (typeof localStorage !== "undefined" && localStorage.getItem("miCarrito") && JSON.parse(localStorage.getItem("miCarrito")).length >= 1) {
                            let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                            let totalValor = 0.00;
                            let cantidad = 0;
                            carrito.forEach(producto => {
                                if (producto.cantidad == 1) {
                                    totalValor += producto.precio;
                                } else {
                                    totalValor += (producto.precio * producto.cantidad);
                                }
                                cantidad += producto.cantidad;
                            });
                            subtotal.textContent = totalValor.toFixed(2);
                            // Suma gastos de envío (1.90 + 0.12 cent por cada unidad);
                            envio.textContent = (1.90 + (0.12 * cantidad)).toFixed(2);
                            totalValor = totalValor + 1.90 + (0.12 * cantidad) - descuento.textContent;
                            total.textContent = totalValor.toFixed(2);
                        } else {
                            descuento.textContent = 0.00;
                            subtotal.textContent = 0.00;
                            total.textContent = 0.00;
                            envio.textContent = 0.00;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">crearFila()</p>
                <small style="font-size: 0.8rem">Crea una fila con cada producto del carrito</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function crearFila(element) {
                        const fila = document.createElement("tr");
                        fila.setAttribute("class", "hover:bg-blue-100/20 duration-300")
                    
                        const tdNombre = document.createElement("td");
                        tdNombre.setAttribute("class", "p-4 text-sm font-medium");
                        tdNombre.innerHTML = `
                            div class='flex items-center gap-2'>
                                div class='w-12 h-12 rounded border' style='background-image: url("../../img_bbdd/productos/${element.id}.jpg"); background-size: cover; background-position: center bottom;'>
                                /div>
                                div>
                                    p>${element.nombre}/p>
                                    p class="text-sm font-normal text-blue-300">${element.tienda}/p>
                                /div>
                            /div>
                        `;
                        fila.appendChild(tdNombre);
                    
                        const tdPrecio = document.createElement("td");
                        tdPrecio.setAttribute("class", "p-4 text-sm");
                        tdPrecio.textContent = `${element.precio.toFixed(2)}€`;
                        fila.appendChild(tdPrecio);
                    
                        const tdCantidad = document.createElement("td");
                        tdCantidad.setAttribute("class", "p-4 text-sm text-center");
                        tdCantidad.innerHTML = `
                            div class="flex gap-2">
                                button onclick='aumentarCantidad(${element.id})' class="cursor-pointer duration-300 bg-white border border-blue-200 hover:bg-green-500 w-5 h-5 font-bold rounded-full" onclick="aumentarCantidad(id)">
                                    p class="relative bottom-0.5">+/p>
                                /button>
                                p>${element.cantidad}/p>
                                button onclick='reducirCantidad(${element.id})' class="cursor-pointer duration-300 bg-white border border-blue-200 hover:bg-red-500 w-5 h-5 font-bold rounded-full" onclick="reducirCantidad(id)">
                                    p class="relative bottom-0.5">-/p>
                                /button>
                            /div>
                        `;
                        fila.appendChild(tdCantidad);
                    
                        const tdTotal = document.createElement("td");
                        tdTotal.setAttribute("class", "p-4 text-sm");
                        tdTotal.textContent = `${(element.precio * element.cantidad).toFixed(2)}€`;
                        fila.appendChild(tdTotal);
                    
                        const tdEliminar = document.createElement("td");
                        tdEliminar.setAttribute("class", "p-4 text-sm text-center");
                        tdEliminar.innerHTML = `
                        button
                        class="cursor-pointer duration-300 bg-white border border-red-500 text-red-500 hover:text-white hover:bg-red-500 w-5 h-5 rounded-full"
                        onclick="eliminarProducto(${element.id})">
                            p class="relative bottom-0.5">x/p>
                        /button>
                        `;
                        fila.appendChild(tdEliminar);
                    
                        return fila;
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">crearFila()</p>
                <small style="font-size: 0.8rem">Crea una fila con cada producto del carrito</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function crearFila(element) {
                        const fila = document.createElement("tr");
                        fila.setAttribute("class", "hover:bg-blue-100/20 duration-300")
                    
                        const tdNombre = document.createElement("td");
                        tdNombre.setAttribute("class", "p-4 text-sm font-medium");
                        tdNombre.innerHTML = `
                            div class='flex items-center gap-2'>
                                div class='w-12 h-12 rounded border' style='background-image: url("../../img_bbdd/productos/${element.id}.jpg"); background-size: cover; background-position: center bottom;'>
                                /div>
                                div>
                                    p>${element.nombre}/p>
                                    p class="text-sm font-normal text-blue-300">${element.tienda}/p>
                                /div>
                            /div>
                        `;
                        fila.appendChild(tdNombre);
                    
                        const tdPrecio = document.createElement("td");
                        tdPrecio.setAttribute("class", "p-4 text-sm");
                        tdPrecio.textContent = `${element.precio.toFixed(2)}€`;
                        fila.appendChild(tdPrecio);
                    
                        const tdCantidad = document.createElement("td");
                        tdCantidad.setAttribute("class", "p-4 text-sm text-center");
                        tdCantidad.innerHTML = `
                            div class="flex gap-2">
                                button onclick='aumentarCantidad(${element.id})' class="cursor-pointer duration-300 bg-white border border-blue-200 hover:bg-green-500 w-5 h-5 font-bold rounded-full" onclick="aumentarCantidad(id)">
                                    p class="relative bottom-0.5">+/p>
                                /button>
                                p>${element.cantidad}/p>
                                button onclick='reducirCantidad(${element.id})' class="cursor-pointer duration-300 bg-white border border-blue-200 hover:bg-red-500 w-5 h-5 font-bold rounded-full" onclick="reducirCantidad(id)">
                                    p class="relative bottom-0.5">-/p>
                                /button>
                            /div>
                        `;
                        fila.appendChild(tdCantidad);
                    
                        const tdTotal = document.createElement("td");
                        tdTotal.setAttribute("class", "p-4 text-sm");
                        tdTotal.textContent = `${(element.precio * element.cantidad).toFixed(2)}€`;
                        fila.appendChild(tdTotal);
                    
                        const tdEliminar = document.createElement("td");
                        tdEliminar.setAttribute("class", "p-4 text-sm text-center");
                        tdEliminar.innerHTML = `
                        button
                        class="cursor-pointer duration-300 bg-white border border-red-500 text-red-500 hover:text-white hover:bg-red-500 w-5 h-5 rounded-full"
                        onclick="eliminarProducto(${element.id})">
                            p class="relative bottom-0.5">x/p>
                        /button>
                        `;
                        fila.appendChild(tdEliminar);
                    
                        return fila;
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">eliminarProducto()</p>
                <small style="font-size: 0.8rem">Elimina un producto del carrito</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function eliminarProducto(id) {
                        let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                        carrito.splice(obtenerPosicionProducto(carrito, id), 1);
                        localStorage.setItem("miCarrito", JSON.stringify(carrito));
                        mostrarProductos();
                        calcularCostes();
                    }
                    
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">aumentarCantidad()</p>
                <small style="font-size: 0.8rem">Aumenta la cantidad de un producto del carrito</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function aumentarCantidad(id) {
                        let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                        let pos = obtenerPosicionProducto(carrito, id);
                        if (carrito[pos].cantidad  99) {
                            carrito[pos].cantidad = carrito[pos].cantidad + 1;
                            localStorage.setItem("miCarrito", JSON.stringify(carrito));
                            mostrarProductos();
                            calcularCostes();
                        } else {
                            return true;
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">reducirCantidad()</p>
                <small style="font-size: 0.8rem">Reduce la cantidad de un producto del carrito o lo elimina si llega a
                    0</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function reducirCantidad(id) {
                        let carrito = JSON.parse(localStorage.getItem("miCarrito"));
                        let pos = obtenerPosicionProducto(carrito, id);
                        if (carrito[pos].cantidad != 1) {
                            carrito[pos].cantidad = carrito[pos].cantidad - 1;
                            localStorage.setItem("miCarrito", JSON.stringify(carrito));
                            mostrarProductos();
                            calcularCostes();
                        } else {
                            eliminarProducto(id);
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">reducirCantidad()</p>
                <small style="font-size: 0.8rem">Obtiene la posición de un producto del carrito</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function obtenerPosicionProducto(carrito, id) {
                        const pos = carrito.findIndex(function (producto) {
                            return producto.id == id;
                        });
                    
                        return pos;
                    }
                </code>
            </pre>
        </section>

    </article>

    <article class="container border rounded py-2 mb-3">
        <h4 class="bg-primary text-white rounded p-2 mb-4">crear_peticion.js</h4>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">"-"()</p>
                <small style="font-size: 0.8rem">Envía una petición de ayuda por medio de la Api Fetch</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    btnEnviar.onclick = function () {
                        try {
                            validarAsunto();
                            validarDescripcion();
                            if (validarAsunto() && validarDescripcion()) {
                                datos = {
                                    'id': localStorage.getItem('id'),
                                    'asunto': asunto.value,
                                    'descripcion': descripcion.value,
                                }
                                fetch("../../php/usuarios/enviar_mensaje_usuario.php", {
                                    method: "POST",
                                    body: JSON.stringify(datos),
                                    headers: {
                                        "Content-Type": "application/json"
                                    }
                                })
                                .then(response => {
                                        if (!response.ok) {
                                            throw new Error('Error en la solicitud');
                                        }
                                        return response.text();
                                    })
                                .then(data => {
                                        const respuestaPeticion = document.getElementById("respuestaPeticion");
                                        const avisoPeticon = document.createElement("p");
                                        respuestaPeticion.innerHTML = "";
                                        console.log(data)
                                        if (data == "Creada") {
                                            avisoPeticon.setAttribute("class", "w-full text-center rounded text-green-600 bg-green-200 py-2");
                                            avisoPeticon.textContent = "Se ha creado correctamente la petición. Revisa el correo para recibir respuesta";
                                            respuestaPeticion.appendChild(avisoPeticon);
                                        } else {
                                            avisoPeticon.setAttribute("class", "w-full text-center rounded text-red-600 bg-red-200 py-2");
                                            avisoPeticon.textContent = "No se ha podido crear la petición correctamente. Inténtalo de nuevo.";
                                            respuestaPeticion.appendChild(avisoPeticon);
                                        }
                                    })
                                    .catch(error => {
                                        console.error("Error: No se ha podido crear la petición ->", error);
                                    });
                            }
                        } catch (e) {
                            const respuestaPeticion = document.getElementById("respuestaPeticion");
                            const avisoPeticon = document.createElement("p");
                            respuestaPeticion.innerHTML = "";
                            avisoPeticon.setAttribute("class", "w-full text-center rounded text-red-600 bg-red-200 py-2");
                            avisoPeticon.textContent = "No se ha podido crear la petición correctamente. Inténtalo de nuevo.";
                            respuestaPeticion.appendChild(avisoPeticon);
                            console.log("No se ha podido crear la petición: " + e);
                        }
                    
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarAsunto()</p>
                <small style="font-size: 0.8rem">Valida que el asunto cumple los requisitos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarAsunto() {
                        try {
                            const expAsunto = /^[\wñÑÁáÉéÍíÓóÚú.,:;"'¡¿\s]{10,50}$/i;
                            const msgAsunto = document.getElementById("msgAsunto");
                            if (expAsunto.test(asunto.value)) {
                                asunto.setAttribute(
                                    "class",
                                    "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgAsunto.setAttribute("class", "hidden");
                    
                                return true;
                            } else {
                                asunto.setAttribute(
                                    "class",
                                    "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgAsunto.setAttribute("class", "flex");
                    
                                return false;
                            }
                        } catch (error) {
                            console.log(`No se ha podido validar el asunto: ${error}`);
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarDescripcion()</p>
                <small style="font-size: 0.8rem">Valida que la descripción cumple los requisitos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarDescripcion() {
                        try {
                            const msgDescripcion = document.getElementById("msgDescripcion");
                            const expDescripcion = /^[\wñÑÁáÉéÍíÓóÚú.,:;"'¡¿\s]{10,200}$/i;
                    
                            if (expDescripcion.test(descripcion.value)) {
                                descripcion.setAttribute(
                                    "class",
                                    "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgDescripcion.setAttribute("class", "hidden");
                    
                                return true;
                            } else {
                                descripcion.setAttribute(
                                    "class",
                                    "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgDescripcion.setAttribute("class", "flex");
                    
                                return false;
                            }
                        } catch (error) {
                            console.log(`No se ha podido validar la descripción: ${error}`);
                        }
                    }
                </code>
            </pre>
        </section>
    </article>

    <article class="container border rounded py-2 mb-3">
        <h4 class="bg-primary text-white rounded p-2 mb-4">gestion_sesiones.js</h4>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">comprobarSesion()</p>
                <small style="font-size: 0.8rem">Comprueba que la sesión es correcta si es usuario y en caso contrario
                    redirige al lugar correcto</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function comprobarSesion(){
                        const tipoUsuario = localStorage.getItem("tipoUsuario");
                        if(tipoUsuario !== "usuario"){
                            if(tipoUsuario !== null){
                                
                                const redirecciones = {
                                    'proveedor': '../proveedores/inicio.html',
                                    'rider': '../riders/inicio.html',
                                    'administrador': '../administrador/inicio.html',
                                }
                    
                                window.location.href = redirecciones[tipoUsuario];
                            }else{
                                window.location.href = '../index.html';
                            }
                        }else{
                            return true;
                        }
                    }
                </code>
            </pre>
        </section>
    </article>

    <article class="container border rounded py-2 mb-3">
        <h4 class="bg-primary text-white rounded p-2 mb-4">listar_pedidos.js</h4>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">iniciarPedidos()</p>
                <small style="font-size: 0.8rem">Función con la que se da comienzo al script</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function iniciarPedidos() {
                        fecha.addEventListener("change", listarPedidos);
                        listarPedidos();
                        listarPedidosActivos();
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">crearComponentePedido(element)</p>
                <small style="font-size: 0.8rem">Crea los distintos componentes del pedido</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function crearComponenteFila(element) {
                        const fila = document.createElement("tr");
                        fila.setAttribute("class", "p-4 text-sm font-medium text-blue-800");
                    
                        const id = document.createElement("td");
                        id.setAttribute("class", "p-4 text-sm font-medium text-blue-800");
                        id.setAttribute("scope", "col");
                        id.textContent = element['num_ven'];
                        fila.appendChild(id);
                    
                        const producto = document.createElement("td");
                        producto.setAttribute("class", "p-4 text-sm font-medium text-blue-800");
                        producto.setAttribute("scope", "col");
                        if(element['cod_prod'] == 0){
                            producto.innerHTML = "-";
                        }else{
                            producto.innerHTML = `
                            div class='flex items-center gap-2'>
                                div class="w-12 h-12 rounded border" style="background-image: url('../../img_bbdd/productos/${element['cod_prod']}.jpg'); background-size: cover; background-position: center bottom;">
                                /div>
                                div>
                                    p>${element['den_prod']}/p>
                                    p class="text-sm font-normal text-blue-300">${element['razsoc']}/p>
                                /div>
                            /div>
                        `;
                        }
                        
                        fila.appendChild(producto);
                    
                        const cantidad = document.createElement("td");
                        cantidad.setAttribute("class", "p-4 text-sm font-medium text-blue-800");
                        cantidad.setAttribute("scope", "col");
                        cantidad.textContent = element['cant_det'];
                        fila.appendChild(cantidad);
                    
                        const direccion = document.createElement("td");
                        direccion.setAttribute("class", "p-4 text-sm font-medium text-blue-800");
                        direccion.setAttribute("scope", "col");
                        direccion.textContent = element['DIR_VEN'];
                        fila.appendChild(direccion);
                    
                        const fecha = document.createElement("td");
                        fecha.setAttribute("class", "p-4 text-sm font-medium text-blue-800");
                        fecha.setAttribute("scope", "col");
                        fecha.textContent = element['FECH_VEN'];
                        fila.appendChild(fecha);
                    
                        const estado = document.createElement("td");
                        estado.setAttribute("class", "p-4 text-sm font-medium text-blue-800");
                        estado.setAttribute("scope", "col");
                        estado.textContent = element['ESTADO_VEN'];
                        fila.appendChild(estado);
                    
                        return fila;
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">listarPedidos()</p>
                <small style="font-size: 0.8rem">Crea la lista de los pedidos pedidos anteriormente</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function listarPedidos() {

                        let valorFecha = "";
                        if (fecha.value == "") {
                            valorFecha = "";
                        } else {
                            const fechaTipo = new Date(fecha.value);
                            valorFecha = `${fechaTipo.getDate().toString().padStart(2, '0')}-${(fechaTipo.getMonth() + 1).toString().padStart(2, '0')}-${fechaTipo.getFullYear()}`;
                        }
                    
                        const datos = {
                            'id': localStorage.getItem("id"),
                            fecha: valorFecha
                        }
                        fetch("../../php/usuarios/listar_pedidos_usuario.php", {
                            method: "POST",
                            body: JSON.stringify(datos),
                            headers: {
                                "Content-Type": "application/json"
                            }
                        })
                            .then(response => response.json())
                            .then(data => {
                                const historialPedidos = document.getElementById("historialPedidos");
                                historialPedidos.innerHTML = "";
                                data.forEach(element => {
                                    historialPedidos.appendChild(crearComponenteFila(element));
                                });
                            })
                            .catch(error => {
                                console.error("Error: No se ha podido crear la petición ->", error);
                            });
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">listarPedidosActivos()</p>
                <small style="font-size: 0.8rem">Crea la lista de los pedidos pedidos que estan ahora pedidos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function listarPedidosActivos() {
                        const datos = {
                            'id': localStorage.getItem("id")
                        }
                        fetch("../../php/usuarios/listar_pedidos_activos_usuario.php", {
                            method: "POST",
                            body: JSON.stringify(datos),
                            headers: {
                                "Content-Type": "application/json"
                            }
                        })
                            .then(response => response.json())
                            .then(data => {
                                const pedidosActivos = document.getElementById("pedidosActivos");
                                if (data.msg == 'Sin resultados') {
                                    pedidosActivos.innerHTML = "<p>No tienes pedidos en activo 🛍️</p>"
                                } else {
                                    data.forEach(element => {
                                        pedidosActivos.appendChild(crearComponentePedido(element));
                                    });
                                }
                            })
                            .catch(error => {
                                console.error("Error: No se ha podido crear la petición ->", error);
                            });
                    }
                </code>
            </pre>
        </section>
    </article>

    <article class="container border rounded py-2 mb-3">
        <h4 class="bg-primary text-white rounded p-2 mb-4">productos_tienda.js</h4>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">iniciarTienda()</p>
                <small style="font-size: 0.8rem">Función con la que se da comienzo al script</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    
                    function iniciarTienda() {
                        mostrarMapa();
                        determinarValoracion();
                        mostrarProductos();
                        ordenPrecio.addEventListener("click", ordenarProductos);
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">determinarValoracion()</p>
                <small style="font-size: 0.8rem">Crea la valoracion y la imagen que le acompaña</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function determinarValoracion() {
                        const iconoValoracion = document.getElementById("iconoValoracion");
                        const valoracion = document.getElementById("valoracion");
                    
                        if (valoracion.textContent >= 4) {
                            iconoValoracion.setAttribute("src", "../../assets/svg/valoracion_top.svg")
                            valoracion.setAttribute("class", "font-bold text-yellow-500");
                        }
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">ordenarProductos()</p>
                <small style="font-size: 0.8rem">Ordena los productos dependiendo de lo seleccionado</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function ordenarProductos() {
                        const orden = document.getElementById("orden");
                        if (orden.value == "precio") {
                            ordenPrecio.setAttribute("class", "duration-300 rounded-full border px-3 py-1 hover:bg-blue-100/50 cursor-pointer");
                            orden.value = "";
                        } else {
                            ordenPrecio.setAttribute("class", "rounded-full px-3 py-1 bg-blue-900 text-white cursor-pointer");
                            orden.value = "precio";
                        }
                    
                        mostrarProductos();
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">mostrarProductos()</p>
                <small style="font-size: 0.8rem">Crea los productos a partir de la base de Datos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function mostrarProductos() {
                        const cifProv = document.getElementById("cifProv");
                        const orden = document.getElementById("orden");
                    
                        const listadoProductos = document.getElementById("listadoProductos");
                    
                        const datos = {
                            cif: cifProv.value,
                            orden: orden.value,
                        }
                    
                        fetch("../../php/usuarios/listar_productos_tienda.php", {
                            method: "POST",
                            body: JSON.stringify(datos),
                            headers: {
                                "Content-Type": "application/json"
                            }
                        })
                            .then(response => response.json())
                            .then(data => {
                    
                                listadoProductos.innerHTML = "";
                    
                                if (data.length > 0) {
                                    data.forEach(element => {
                                        listadoProductos.appendChild(crearComponenteProducto(element));
                                    });
                                } else {
                                    listadoProductos.appendChild(crearComponenteSinResultados());
                                }
                    
                            })
                            .catch(error => {
                                listadoProductos.innerHTML = "";
                                listadoProductos.appendChild(crearComponenteSinResultados());
                                console.error("Error: No se ha podido obtener los datos de todas las tiendas -> ", error);
                            });
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">comprobarTop()</p>
                <small style="font-size: 0.8rem">Comprueba las tiendas top</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function comprobarTop() {
                        const valoracion = document.getElementById("valoracion");
                        const iconoValoracion = document.getElementById("iconoValoracion");
                        if (valoracion.textContent >= 4.0) {
                            valoracion.setAttribute("class", "text-yellow-500 font-bold");
                            iconoValoracion.setAttribute("src", "../../assets/svg/valoracion_top.svg");
                        }
                    }function comprobarTop() {
                        const valoracion = document.getElementById("valoracion");
                        const iconoValoracion = document.getElementById("iconoValoracion");
                        if (valoracion.textContent >= 4.0) {
                            valoracion.setAttribute("class", "text-yellow-500 font-bold");
                            iconoValoracion.setAttribute("src", "../../assets/svg/valoracion_top.svg");
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">crearComponenteProducto(element)</p>
                <small style="font-size: 0.8rem">Comprueba los componentes de los productos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function crearComponenteProducto(element) {
                        const componente = document.createElement("div");
                        componente.setAttribute("class", "col-span-1 lg:col-span-1 md:col-span-1 antialiased text-gray-900");
                        const imagen = document.createElement("div");
                        imagen.setAttribute("class", "w-full rounded-lg shadow-sm border");
                        imagen.style.height = "250px";
                        imagen.style.backgroundImage = `url('../../img_bbdd/productos/${element['COD_PROD']}.jpg')`;
                        imagen.style.backgroundSize = "cover";
                        imagen.style.backgroundPosition = "bottom";
                    
                        const data = document.createElement("div");
                        data.setAttribute("class", "relative px-4 -mt-12");
                        const fondoData = document.createElement("div");
                        fondoData.setAttribute("class", "bg-white p-5 rounded-lg shadow-lg hover:shadow-2xl duration-300 flex flex-col justify-between")
                    
                        const denominacion = document.createElement("p");
                        denominacion.setAttribute("class", "font-bold mb-1");
                        denominacion.textContent = element['DEN_PROD'];
                        fondoData.appendChild(denominacion);
                    
                    
                        const zonaInferior = document.createElement("div");
                        zonaInferior.setAttribute("class", "flex justify-between gap-3 items-center mt-1");
                    
                        const precio = document.createElement("h4");
                        precio.setAttribute("class", "font-semibold");
                        precio.textContent = `${element['PU_PROD']} €`;
                        zonaInferior.appendChild(precio);
                    
                        const boton = document.createElement("button");
                        boton.setAttribute("class", "duration-300 text-white flex items-center justify-center bg-indigo-700 rounded-md hover:bg-indigo-800 w-10 h-10 text-xl");
                        //boton.setAttribute("onclick", "addProducto(" + element['COD_PROD'] + "," + element['PU_PROD'] + ",'" + element['DEN_PROD'] + "','" + razSoc.value + ")");
                        boton.setAttribute("onclick", `addProducto(${element['COD_PROD']}, ${element['PU_PROD']}, '${element['DEN_PROD']}', '${razSoc.value}')`);
                        const imgBtn = document.createElement("img");
                        imgBtn.setAttribute("alt", "+");
                        imgBtn.setAttribute("src", "../../assets/svg/agregar.svg");
                        boton.appendChild(imgBtn);
                        zonaInferior.appendChild(boton);
                    
                        fondoData.appendChild(denominacion);
                        fondoData.appendChild(zonaInferior);
                        data.appendChild(fondoData);
                        componente.appendChild(imagen);
                        componente.appendChild(data);
                    
                        return componente;
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">crearComponenteSinResultados()</p>
                <small style="font-size: 0.8rem">Comprueba los componentes de los productos en el caso que no haya
                    productos en una tienda</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function crearComponenteSinResultados() {
                        const p = document.createElement("p");
                        p.textContent = "No se han encontrado productos para esta tienda 😢";
                        p.setAttribute("class", "col-span-4");
                        p.style.textAlign = "center";
                    
                        return p;
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">mostrarMapa()</p>
                <small style="font-size: 0.8rem">Crea el mapa con las coordenadas de la tienda</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function mostrarMapa() {
                        let marker;
                    
                        let map = L.map('map').setView([40.314224, -3.7038], 16)
                    
                        //Agregar tilelAyer mapa base desde openstreetmap
                        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                            attribution: copy; a href="https://www.openstreetmap.org/copyright">OpenStreetMap for DailyGo/a> contributors'
                        }).addTo(map);
                    
                        
                    
                            let coordenadas = coords.value.split(",");
                            map.flyTo(coordenadas, 16);
                            
                            const lat = coordenadas[0];
                            const lng = coordenadas[1];
                    
                    
                            // Eliminar cualquier marcador anterior
                            if (marker) {
                                map.removeLayer(marker);
                            }
                    
                            // Crear un marcador y agregarlo al mapa
                            marker = L.marker([lat, lng]).addTo(map);
                    
                            // Centrar el mapa en la ubicación seleccionada
                            map.flyTo([lat, lng], 16);
                    
                            const chincheta = document.querySelectorAll(".leaflet-marker-pane")[0];
                            const imagen = chincheta.childNodes[0];
                            imagen.setAttribute("src", `../../img_bbdd/proveedores/${cifProv.value}.jpg`);
                            imagen.setAttribute("id", "img_chincheta");
                    }
                    
                </code>
            </pre>
        </section>
    </article>
    <article class="container border rounded py-2 mb-3">
        <h4 class="bg-primary text-white rounded p-2 mb-4">registro_usuarios.js</h4>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">iniciarEventos()</p>
                <small style="font-size: 0.8rem">Función con la que se da comienzo al script</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    
                    function iniciarEventos() {
                        try {
                            nombre.addEventListener("input", validarNombre);
                            apellidos.addEventListener("input", validarApellidos);
                            telefono.addEventListener("input", validarTelefono);
                            correo.addEventListener("input", validarCorreo);
                            contrasena.addEventListener("input", validarContrasena);
                            confirmarContrasena.addEventListener("input", validarConfirmarContrasena);
                            terminos.addEventListener("click", validarTerminos);
                    
                            crearCuenta.addEventListener("click", peticionCrearUsuario);
                        } catch (error) {
                            console.log(
                                `Los eventos no están funcionando correctamente: ${error}`
                            );
                        }
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarCorreo()</p>
                <small style="font-size: 0.8rem">Valida que el correo esté bien</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarCorreo() {
                        try {
                            const expCorreo = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                    
                            if (expCorreo.test(correo.value)) {
                                xhrCorreo.onreadystatechange = respuestaExisteCorreo;
                                xhrCorreo.open("POST", "../php/usuarios/registro_usuario.php", true);
                                xhrCorreo.setRequestHeader(
                                    "Content-type",
                                    "application/x-www-form-urlencoded"
                                );
                                xhrCorreo.send(`correoExistente=${correo.value}`);
                    
                                correoValidado = true;
                            } else {
                                correo.setAttribute(
                                    "class",
                                    "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgCorreo.setAttribute("class", "flex");
                                msgCorreoExiste.setAttribute("class", "hidden");
                    
                                correoValidado = false;
                            }
                        } catch (error) {
                            console.log(`No se ha podido validar el correo: ${error}`);
                        }
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">respuestaExisteCorreo()</p>
                <small style="font-size: 0.8rem">Comprueba si el correo ya existe en la base de dato</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function respuestaExisteCorreo() {
                        try {
                            if (xhrCorreo.readyState == 4 && xhrCorreo.status == 200) {
                                let respuestaPhp = xhrCorreo.responseText;
                    
                                if (respuestaPhp == "no existe") {
                                    correo.setAttribute(
                                        "class",
                                        "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                    );
                                    msgCorreoExiste.setAttribute("class", "hidden");
                                    msgCorreo.setAttribute("class", "hidden");
                                    correoComprobadoBaseDatos = true;
                                } else {
                                    correo.setAttribute(
                                        "class",
                                        "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                    );
                                    msgCorreoExiste.setAttribute("class", "flex");
                                    msgCorreo.setAttribute("class", "hidden");
                                    correoComprobadoBaseDatos = false;
                                }
                            }
                        } catch (error) {
                            console.log(
                                `No se ha obtenido respuesta de la existencia del correo: ${error}`
                            );
                        }
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarContrasena()</p>
                <small style="font-size: 0.8rem">Valida que la contraseña tenga los minimos necesarios</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarContrasena() {
                        try {
                            const expContrasena =
                                /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)([A-Za-z\d$@$!%*?&]|[^ ]){8,16}$/;
                    
                            if (expContrasena.test(contrasena.value)) {
                                contrasena.setAttribute(
                                    "class",
                                    "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgContrasena.setAttribute("class", "hidden");
                                contraValidada = true;
                            } else {
                                contrasena.setAttribute(
                                    "class",
                                    "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgContrasena.setAttribute("class", "flex");
                                contraValidada = false;
                            }
                        } catch (error) {
                            console.log(`No se ha podido validar la contraseña: ${error}`);
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarConfirmarContrasena()</p>
                <small style="font-size: 0.8rem">Comprueba que la contraseña la ha escrito bien 2 veces</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarConfirmarContrasena() {
                        try {
                            const expContrasenaRep =
                                /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)([A-Za-z\d$@$!%*?&]|[^ ]){8,16}$/;
                    
                            if (
                                contrasena.value === confirmarContrasena.value &&
                                expContrasenaRep.test(confirmarContrasena.value)
                            ) {
                                confirmarContrasena.setAttribute(
                                    "class",
                                    "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgConfirmarContrasena.setAttribute("class", "hidden");
                                return true;
                            } else {
                                confirmarContrasena.setAttribute(
                                    "class",
                                    "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgConfirmarContrasena.setAttribute("class", "flex");
                                return false;
                            }
                        } catch (error) {
                            console.log(
                                `No se ha podido validar la confirmación de la contraseña: ${error}`
                            );
                        }
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarNombre()</p>
                <small style="font-size: 0.8rem">Comprueba que el nombre sea correcto</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarNombre() {
                        try {
                            const expNombre = /^([a-zA-ZáéíóúÁÉÍÓÚñÑüÜñ]{2,20}\s?)+$/;
                    
                            if (expNombre.test(nombre.value)) {
                                nombre.setAttribute(
                                    "class",
                                    "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgNombre.setAttribute("class", "hidden");
                                nombreValidado = true;
                            } else {
                                nombre.setAttribute(
                                    "class",
                                    "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgNombre.setAttribute("class", "flex");
                                nombreValidado = false;
                            }
                        } catch (error) {
                            console.log(`No se ha podido validar el nombre: ${error}`);
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarApellidos()</p>
                <small style="font-size: 0.8rem">Comprueba que los apellidos sean correctos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarApellidos() {
                        try {
                            const expApellidos = /^([a-zA-ZáéíóúÁÉÍÓÚñÑüÜñ]{2,}\s?-?\s?){1,4}$/;
                    
                            if (expApellidos.test(apellidos.value)) {
                                apellidos.setAttribute(
                                    "class",
                                    "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgApellidos.setAttribute("class", "hidden");
                                apellidoValidado = true;
                            } else {
                                apellidos.setAttribute(
                                    "class",
                                    "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgApellidos.setAttribute("class", "flex");
                                apellidoValidado = false;
                            }
                        } catch (error) {
                            console.log(`No se ha podido validar los apellidos: ${error}`);
                        }
                    }
                    
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarTelefono()</p>
                <small style="font-size: 0.8rem">Valida que el teléfono sea correcto</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarTelefono() {
                        try {
                            const expTelefono = /^(6|7|8|9)\d{8}$/;
                    
                            if (expTelefono.test(telefono.value)) {
                                xhrTelefono.onreadystatechange = respuestaExisteTelefono;
                                xhrTelefono.open("POST", "../php/usuarios/registro_usuario.php", true);
                                xhrTelefono.setRequestHeader(
                                    "Content-type",
                                    "application/x-www-form-urlencoded"
                                );
                                xhrTelefono.send(`telefonoExistente=${telefono.value}`);
                    
                                telefonoValidado = true;
                            } else {
                                telefono.setAttribute(
                                    "class",
                                    "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                );
                                msgTelefono.setAttribute("class", "flex");
                                msgTelefonoExiste.setAttribute("class", "hidden");
                    
                                telefonoValidado = false;
                            }
                        } catch (error) {
                            console.log(`No se ha podido validar el teléfono: ${error}`);
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">respuestaExisteTelefono()</p>
                <small style="font-size: 0.8rem">Comprueba que el teléfono no se repita</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function respuestaExisteTelefono() {
                        try {
                            if (xhrTelefono.readyState == 4 && xhrTelefono.status == 200) {
                                let jsonTelefono = xhrTelefono.responseText;
                                console.log(jsonTelefono)
                                if (jsonTelefono === "no existe") {
                                    telefono.setAttribute(
                                        "class",
                                        "rounded-md border border-green-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                    );
                                    msgTelefonoExiste.setAttribute("class", "hidden");
                                    msgTelefono.setAttribute("class", "hidden");
                                    telefonoComprobadoBaseDatos = true;
                                } else {
                                    telefono.setAttribute(
                                        "class",
                                        "rounded-md border border-red-500 p-2 bg-blue-100/10 focus:bg-blue-100/30 duration-300"
                                    );
                                    msgTelefonoExiste.setAttribute("class", "flex");
                                    msgTelefono.setAttribute("class", "hidden");
                                    telefonoComprobadoBaseDatos = false;
                                }
                            }
                        } catch (error) {
                            console.log(
                                `No se ha podido obtener la respuesta de la existencia del teléfono: ${error}`
                            );
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">validarTerminos()</p>
                <small style="font-size: 0.8rem">Comprueba que ha aceptado los terminos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function validarTerminos() {
                        try {
                            if (terminos.checked) {
                                msgTerminos.setAttribute("class", "hidden");
                                terminosValidados = true;
                            } else {
                                msgTerminos.setAttribute("class", "flex");
                                terminosValidados = false;
                            }
                        } catch (error) {
                            console.log(`No se ha podido validar los términos: ${error}`);
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">peticionCrearUsuario()</p>
                <small style="font-size: 0.8rem">Petición al back para crear la cuenta</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function peticionCrearUsuario() {
                        try {
                            if (
                                correoComprobadoBaseDatos == true &&
                                correoValidado == true &&
                                contraValidada == true &&
                                nombreValidado == true &&
                                apellidoValidado == true &&
                                telefonoValidado == true &&
                                telefonoComprobadoBaseDatos == true  &&
                                terminosValidados == true
                            ) {
                                xhrNuevoUsuario.onreadystatechange = respuestaCrearUsuario;
                                xhrNuevoUsuario.open("POST", "../php/usuarios/registro_usuario.php", true);
                                xhrNuevoUsuario.setRequestHeader(
                                    "Content-type",
                                    "application/x-www-form-urlencoded"
                                );
                                xhrNuevoUsuario.send(
                                    `nombre=${nombre.value}&apellidos=${apellidos.value}&correo=${correo.value}&contrasena=${contrasena.value}&telefono=${telefono.value}`
                                );
                            }
                        } catch (error) {
                            console.log(`No se ha podido solicitar crear usuario: ${error}`);
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">respuestaCrearUsuario()</p>
                <small style="font-size: 0.8rem">Respuesta a la petición al back para crear la cuenta</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function respuestaCrearUsuario() {
                        try {
                            if (xhrNuevoUsuario.readyState == 4 && xhrNuevoUsuario.status == 200) {
                                let respuestaUsuario = xhrNuevoUsuario.responseText;
                                console.log(respuestaUsuario)
                                if (respuestaUsuario === "creado") {
                                    localStorage.setItem("nombre", nombre.value);
                                    localStorage.setItem("apellidos", apellidos.value);
                                    localStorage.setItem("correo", correo.value);
                                    localStorage.setItem("telefono", apellidos.value);
                                    localStorage.setItem("tipoUsuario", "usuario");
                                    window.location.href = "../src/index.html";
                                } else {
                                    const errorCrear = document.getElementById("errorCrear");
                                    errorCrear.setAttribute("class", "flex");
                                }
                            }
                        } catch (error) {
                            console.log(
                                `No se ha podido obtener respuesta de la creación del usuario: ${error}`
                            );
                        }
                    }
                    
                </code>
            </pre>
        </section>
    </article>
    <article class="container border rounded py-2 mb-3">
        <h4 class="bg-primary text-white rounded p-2 mb-4">tiendas.js</h4>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">iniciarTiendas()</p>
                <small style="font-size: 0.8rem">Función con la que se da comienzo al script</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    
                    function iniciarTiendas() {
                        if ((filename() == "inicio.php") || (filename() == "inicio.php#info-ayuda.php")) {
                            tiendasTop();
                        }
                    
                        try {
                            CarouselCategorias();
                            buscarTiendas();
                            eliminarFiltros.addEventListener("click", quitarFiltros);
                            nombreTienda.addEventListener("input", buscarTiendas);
                        } catch (e) {
                            console.log("Página de Inicio 🏠");
                        }
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">ordenarTiendas(tipo)</p>
                <small style="font-size: 0.8rem">Ordena las tiendas nada mas meterse a verlas</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function ordenarTiendas(tipo) {
                        if (orden.value == "TIEMPO") {
                            ordenTiempo.setAttribute("class", "duration-300 rounded-full border px-3 py-1 hover:bg-blue-100/50 cursor-pointer");
                            orden.value = "rand";
                            buscarTiendas();
                        } else {
                            ordenTiempo.setAttribute("class", "duration-300 rounded-full border px-3 py-1 bg-blue-800 text-white hover:bg-blue-900 cursor-pointer");
                            orden.value = "TIEMPO";
                            buscarTiendas();
                        }
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">quitarFiltros()</p>
                <small style="font-size: 0.8rem">Quita los filtros para buscar las tiendas</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function quitarFiltros() {
                        ordenTiempo.setAttribute("class", "duration-300 rounded-full border px-3 py-1 hover:bg-blue-100/50 cursor-pointer");
                        orden.value = "rand";
                        categoria.value = "";
                        tituloResultados.textContent = `Resultados`;
                        nombreTienda.value = "";
                        buscarTiendas();
                    }
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">buscarTiendas()</p>
                <small style="font-size: 0.8rem">Busca las tiendas por escritura</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function buscarTiendas() {
                        const listadoTiendas = document.getElementById("listadoTiendas");
                    
                        const datos = {
                            tienda: nombreTienda.value,
                            categoria: categoria.value,
                            orden: orden.value
                        }
                    
                        console.log(datos);
                    
                        fetch("../../php/usuarios/listar_tiendas.php", {
                            method: "POST",
                            body: JSON.stringify(datos),
                            headers: {
                                "Content-Type": "application/json"
                            }
                        })
                            .then(response => response.json())
                            .then(data => {
                    
                                listadoTiendas.innerHTML = "";
                    
                                if (data.length > 0) {
                                    data.forEach(element => {
                                        listadoTiendas.appendChild(crearComponenteTienda(element));
                                    });
                                } else {
                                    listadoTiendas.appendChild(crearComponenteSinResultados())
                                }
                            })
                            .catch(error => {
                                console.error("Error: No se ha podido obtener los datos de todas las tiendas -> ", error);
                            });
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">filename()</p>
                <small style="font-size: 0.8rem">Busca las imagenes</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function filename() {
                        const rutaAbsoluta = self.location.href;
                        const posicionUltimaBarra = rutaAbsoluta.lastIndexOf("/");
                        const rutaRelativa = rutaAbsoluta.substring(posicionUltimaBarra + "/".length, rutaAbsoluta.length);
                        return rutaRelativa;
                    }
                </code>
            </pre>
        </section>

        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">tiendasTop()</p>
                <small style="font-size: 0.8rem">Pone las tiendas que estan en el TOP</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function tiendasTop() {
                        const listadoTiendas = document.getElementById("listadoTiendas");
                        listadoTiendas.innerHTML = "";
                    
                        fetch("../../php/usuarios/tiendas_top.php", {
                            method: "POST",
                            body: null,
                            headers: {
                                "Content-Type": "application/json"
                            }
                        })
                            .then(response => response.json())
                            .then(data => {
                                if (data.length > 0) {
                                    data.forEach(element => {
                                        listadoTiendas.appendChild(crearComponenteTienda(element));
                                    });
                                } else {
                                    listadoTiendas.appendChild(crearComponenteSinResultados());
                                }
                            })
                            .catch(error => {
                                console.error("Error: No se ha podido obtener los datos de todas las tiendas -> ", error);
                            });
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">CarouselCategorias()</p>
                <small style="font-size: 0.8rem">Muestra las distintas categorias en un carrousel</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function CarouselCategorias() {
                        try {
                            const swiper = new Swiper(".mySwiper", {
                                slidesPerView: 3,
                                spaceBetween: 3,
                                pagination: {
                                    el: ".swiper-pagination",
                                    clickable: true,
                                },
                                breakpoints: {
                                    640: {
                                        slidesPerView: 7,
                                        spaceBetween: 5,
                                    },
                                    768: {
                                        slidesPerView: 8,
                                        spaceBetween: 5,
                                    },
                                    1024: {
                                        slidesPerView: 10,
                                        spaceBetween: 5,
                                    },
                                },
                            });
                        } catch (e) {
                            console.log("No hay swiper en está página")
                        }
                    }
                    
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">filtrarCategoria(nombre)</p>
                <small style="font-size: 0.8rem">Filtra por nombre</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function filtrarCategoria(nombre) {
                        tituloResultados.textContent = `Resultados por ${nombre}`;
                        categoria.value = nombre;
                        buscarTiendas();
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">crearComponenteTienda(element)</p>
                <small style="font-size: 0.8rem">Creación de componentes dependiendo de los filtros</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function crearComponenteTienda(element) {
                        let valorMedia = parseFloat(element.media).toFixed(1);
                        
                        const componente = document.createElement("form");
                        componente.setAttribute("action", "tienda_productos.php");
                        componente.setAttribute("method", "post");
                        componente.style.height = "200px";
                        componente.style.backgroundImage = `linear-gradient(to bottom, rgba(16, 14, 52, 0.2), rgba(16, 14, 52, 0.9)), url('../../img_bbdd/fondos/${element['CIF_PROV']}.jpg')`;
                        componente.style.backgroundSize = "cover";
                        componente.style.backgroundPosition = "center";
                        componente.setAttribute("class", "col-span-4 lg:col-span-1 md:col-span-1 shadow-lg hover:shadow-2xl duration-300 cursor-pointer rounded-lg");
                    
                        // VALORES
                        componente.appendChild(datosHiddens(element, valorMedia));
                    
                        const contenedor = document.createElement("button");
                        contenedor.setAttribute("type", "submit");
                        contenedor.setAttribute("class", "w-full h-full flex flex-col justify-end rounded-lg");
                    
                        const contendorTexto = document.createElement("div");
                        contendorTexto.setAttribute("class", "w-full h-fit mx-auto text-center rounded-xl");
                    
                        const datosTienda = document.createElement("div");
                        datosTienda.setAttribute("class", "p-5 mb-5");
                    
                        const razonSocial = document.createElement("h3");
                        razonSocial.setAttribute("class", "text-white font-bold truncate");
                        razonSocial.textContent = `${element['RAZSOC']}`;
                    
                        const categoria = document.createElement("small");
                        categoria.setAttribute("class", "px-2 py-1 bg-indigo-700 rounded-full text-xs text-white");
                        categoria.textContent = `${element['CATEGORIA']}`;
                    
                        datosTienda.appendChild(razonSocial);
                        datosTienda.appendChild(categoria);
                    
                        const datosExtra = document.createElement("div");
                        datosExtra.setAttribute("class", "flex flex-wrap text-sm justify-center gap-3 bg-white p-2.5 rounded-b-lg");
                    
                        const divValoracion = document.createElement("div");
                        divValoracion.setAttribute("class", "flex flex-wrap items-center gap-1");
                    
                        const imgValoracion = document.createElement("img");
                        imgValoracion.style.width = "16px";
                        if (valorMedia >= 4) {
                            imgValoracion.setAttribute("src", "../../assets/svg/valoracion_top.svg");
                        } else {
                            imgValoracion.setAttribute("src", "../../assets/svg/valoracion.svg");
                        }
                    
                        imgValoracion.setAttribute("alt", "valoración");
                    
                        const valoracion = document.createElement("p");
                        valoracion.textContent = valorMedia;
                        if (valorMedia >= 4) {
                            valoracion.setAttribute("class", "text-yellow-500 font-bold");
                        }
                    
                        divValoracion.appendChild(imgValoracion);
                        divValoracion.appendChild(valoracion);
                    
                        const divTiempo = document.createElement("div");
                        divTiempo.setAttribute("class", "flex flex-wrap items-center gap-1");
                    
                        const imgTiempo = document.createElement("img");
                        imgTiempo.style.width = "16px";
                        imgTiempo.setAttribute("src", "../../assets/svg/tiempo.svg");
                        imgTiempo.setAttribute("alt", "tiempo");
                    
                        const tiempo = document.createElement("p");
                        tiempo.textContent = `${element['TIEMPO']} min`;
                    
                        divTiempo.appendChild(imgTiempo);
                        divTiempo.appendChild(tiempo);
                    
                        datosExtra.appendChild(divValoracion);
                        datosExtra.appendChild(divTiempo);
                        contendorTexto.appendChild(datosTienda);
                        contendorTexto.appendChild(datosExtra);
                        contenedor.appendChild(contendorTexto);
                        componente.appendChild(contenedor);
                    
                        return componente;
                    }
                    
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">crearComponenteSinResultados()</p>
                <small style="font-size: 0.8rem">Creación de componentes si no hay tiendas</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function crearComponenteSinResultados() {
                        const p = document.createElement("p");
                        p.textContent = "No se han encontrado resultados 😢 Busca otra tienda ¡Hay miles!";
                        p.setAttribute("class", "col-span-4");
                        p.style.textAlign = "center";
                    
                        return p;
                    }
                    
                </code>
            </pre>
        </section>
        <section class="mb-5">
            <div class="mb-3 ">
                <p class="fw-bold mb-0">datosHiddens(element, media)</p>
                <small style="font-size: 0.8rem">Recoge los datos ocultos</small>
            </div>
            <pre class="bg-dark rounded text-light" style="font-size: 0.7rem;">
                <code>
                    function datosHiddens(element, media) {
                        const div = document.createElement("div");
                        
                        const tipos = ["CIF_PROV", "RAZSOC", "DIR_PROV", "TLF_PROV", "MEDIA", "CATEGORIA", "TIEMPO", "COORDENADAS"];
                    
                        for (let i = 0; i < tipos.length; i++) {
                            const nuevo = document.createElement("input");
                            nuevo.setAttribute("name", tipos[i]);
                            nuevo.setAttribute("type", "hidden");
                            if(tipos[i] == "MEDIA"){
                                nuevo.setAttribute("value", media);
                            }else{
                                nuevo.setAttribute("value", element[tipos[i]]);
                            }
                            div.appendChild(nuevo);
                        }
                        console.log(div);
                        return div;
                    }
                    
                </code>
            </pre>
        </section>
        
    </article>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
        crossorigin="anonymous"></script>
</body>

</html>